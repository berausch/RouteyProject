@{
    ViewData["Title"] = "New Route";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@model Routey.Models.Route
<script>
    $(document).ready(function () {
        $(".ui-widget").hide();
        $(".ui-widgetb").hide();
        $("#route").hide();
        $("#done").hide();
        $("#extendShow").hide();
        $("#radius").selectmenu();
        $("#newDest").hide();
        $("#destQ").hide();

        $("#auto").autocomplete({
            source: function (request, response) {

                $.ajax({
                    url: '@Url.Action("GetAuto")',
                    dataType: "json",
                    data: {
                        term: request.term
                    },
                    success: function (result) {
                        response(result);
                        $("#submitErrand").show();

                    }
                });
            },
            minLength: 2,
            select: function (event, ui) {
                $.ajax({
                    type: 'GET',
                    dataType: 'html',
                    data: {
                        auto: ui.item.value
                    },
                    url: '@Url.Action("GetAddressAuto")',
                    success: function (result) {
                        $("#log").show();
                        $('#log').html(result);
                    }
                });
            }
        });
            $("#auto2").submit(function(event){
                event.preventDefault();
                $.ajax({
                    type: 'GET',
                    dataType: 'html',
                    data: $(this).serialize(),
                    url: '@Url.Action("GetLocations")',
                    success: function (result) {
                        $("#log").show();
                        $('#log').html(result);
                    }
                });
            });
        $("#autoEndAddress").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: '@Url.Action("GetAddressAuto")',
                    dataType: "json",
                    data: {
                        term: request.term
                    },
                    success: function (result) {
                        response(result);
                    }
                });
            },
            minLength: 2,
            select: function (event, ui) {
                $.ajax({
                    type: 'GET',
                    dataType: 'html',
                    data: {
                        auto: ui.item.value
                    },
                    url: '@Url.Action("GetLocations")',
                    success: function (result) {
                        $("#log").show();
                        $('#log').html(result);
                    }
                });
            }
        });
        $("#newDest").submit(function(event){
            event.preventDefault();
            $.ajax({
                type: 'GET',
                dataType: 'html',
                data: $(this).serialize(),
                url: '@Url.Action("GetDestLocations")',
                success: function (result) {
                    $("#log").show();
                    $('#log').html(result);
                }
            });
        });
        $("#newOrigin").submit(function (event) {
            event.preventDefault();
            $.ajax({
                type: 'GET',
                dataType: 'json',
                data: $(this).serialize(),
                url: '@Url.Action("CreateNewOrigin")',
                success: function (result) {
                    var resultStringOrigin = "<br /><hr><h5>Start:</h5> <p>" + result.address + "</p><p>" + result.city + ", " + result.state + "</p>";
                    console.log(result);
                    $("#newOrigin").hide();
                    $("#destQ").show();
                    $('#origin').html(resultStringOrigin);

                }
            });
            });

        $("#destQ").submit(function (event) {
            event.preventDefault();
            $.ajax({
                type: 'GET',
                dataType: 'json',
                data: $(this).serialize(),
                url: '@Url.Action("DestinationQ")',
                success: function (result) {
                    if (result == true) {
                        $("#newDest").show();
                        $("#destQ").hide();

                    } else {
                        
                        console.log(result);
                        $(".ui-widget").show();
                        $("#destQ").hide();

                    }
                }
            });
        });

        $("#endRoute").submit(function (event) {
            event.preventDefault();
            $.ajax({
                type: 'GET',
                dataType: 'json',
                url: '@Url.Action("EndRoute")',
                success: function (result) {
                    console.log(result);
                    var resultLink = '<a href="' + result + '">Map Link</a>';
                    $('#mapLink').html(resultLink);

                }
            });
        });
    });
</script>


<div class="container">
    
    <h2>Routey</h2>
    <h4>Take the Err out of your Errands</h4>
    <hr />
    <br />
    <form id="newOrigin">
        <h5>Create a Starting Point</h5>
        <label for="originAddress">Street Address</label>
        <input id="originAddress" name="originAddress" value="2315 SE Ankeny st">

        <label for="originCity">City</label>
        <input id="originCity" name="originCity" value="Portland">

        <label for="originState">State Abbreviation</label>
        <input id="originState" name="originState" value="OR">

        <button type="submit">Submit</button>
    </form>
    <form id="destQ">
        <h4>What's your Destination?</h4>
        
        <input class="radio" type="radio" name="dest" value="OD" id="radio1"checked />
        <label for="radio1">Same as Start</label>
        <input class="radio" type="radio" name="dest" value="D" id="radio2"/>
        <label for="radio2">Different then Start</label>
        <input class="radio" type="radio" name="dest" value="W" id="radio3"/>
        <label for="radio3">Not sure/Doesn't Matter</label>
        <br />
        <br />
        <button type="submit">Submit</button>
    </form>
    <form id="newDest">
        <label for="auto"><h5>Add Destination Address</h5></label>
        <input id="auto" name="auto">
        <label for="radius">Search Distance (miles)</label>
        <select name="radius" id="radius">
            <option Value="8000">5</option>
            <option Value="16000" selected="selected">10</option>
            <option Value="40000">25</option>
            <option Value="80500">50</option>
            <option Value="161000">100</option>
        </select>
        <input type="hidden" name="locationType" value="D" />
        <button id="submitErrand" type="submit">Submit</button>
    </form>

    <div class="ui-widget">
        <form id="auto2">
            <label for="auto">Add a Stop!</label>
            <input id="auto" name="auto"> 
            <label for="radius">Search Distance (miles)</label>
            <select name="radius" id="radius">
                <option Value="8000">5</option>
                <option Value="16000" selected="selected">10</option>
                <option Value="40000">25</option>
                <option Value="80500">50</option>
                <option Value="161000">100</option>
            </select>
            <input type="hidden" name="locationType" value="W" />
            <button id="submitErrand" type="submit">Submit</button>
        </form>
    </div>

    <div id="extendShow">No Results...</div>
    @*<div class="ui-widgetb">
        <form id="auto2b">
            <label for="autob">Add an Address Stop!</label>
            <input id="autob" name="autob">
            <button class="submitErrand" type="submit">Submit</button>
        </form>
    </div>*@
    <div id="log"></div>

   
    <div id="origin"></div>
    <div id="destinationDiv">
        <h5>Destination</h5>
        <p id="destination"></p>
    </div>
    <div id="route" class="row"><hr /><h5>Locations: </h5></div>
    <div id="done">
        Done with your route?
        <form id="endRoute">
        <button  type="submit">Create your Link!</button>
        </form>    
        <div id="mapLink"></div>
    </div>

 </div>



